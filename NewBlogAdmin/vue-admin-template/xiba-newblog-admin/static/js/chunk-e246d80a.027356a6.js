(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e246d80a"],{"2a12":function(t,e,a){"use strict";a("e40e")},"571c":function(t,e,a){"use strict";a("a1d5")},9406:function(t,e,a){"use strict";a.r(e);a("b0c0");var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dashboard-container"},[t._e(),e("panel-group",{on:{handleSetLineChartData:t.handleSetLineChartData}}),e("el-row",{staticStyle:{background:"#fff",padding:"16px 16px 0","margin-bottom":"32px"}},[e("line-chart",{attrs:{"chart-data":t.lineChartData},on:{PointClick:t.PointClick}})],1),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-table",{directives:[{name:"show",rawName:"v-show",value:"newVisitis"===t.type,expression:"type==='newVisitis'"},{name:"loading",rawName:"v-loading",value:t.tableloading,expression:"tableloading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,height:"350"}},[e("el-table-column",{attrs:{prop:"user_uuid",label:"UUID",width:"310"}}),e("el-table-column",{attrs:{label:"城市名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{domProps:{innerHTML:t._s(t.repla(a.row.city))}})]}}])}),e("el-table-column",{attrs:{label:"用户名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{domProps:{innerHTML:t._s(t.repla(a.row.visitor_names))}})]}}])}),e("el-table-column",{attrs:{label:"微信名",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{domProps:{innerHTML:t._s(t.repla(a.row.wechat_nickname))}})]}}])}),e("el-table-column",{attrs:{label:"头像",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.wechat_headimgurl?e("img",{staticStyle:{width:"40px",height:"40px","border-radius":"40px"},attrs:{src:a.row.wechat_headimgurl}}):t._e()]}}])}),e("el-table-column",{attrs:{prop:"deviceName",label:"设备",width:"310"}}),e("el-table-column",{attrs:{prop:"eeee",label:""}}),e("el-table-column",{attrs:{label:"当前",width:"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[t.isWithinOneMinute(a.row.max_create_time)?e("el-tag",{attrs:{type:"success"}},[t._v("在线 ")]):e("el-tag",[t._v("离线 ")])]}}])}),e("el-table-column",{attrs:{prop:"min_create_time",label:"最早访问时间",width:"180"}}),e("el-table-column",{attrs:{prop:"max_create_time",label:"最后访问时间",width:"180"}}),e("el-table-column",{attrs:{prop:"total_count",label:"访问次数",width:"100",align:"center"}})],1),e("el-table",{directives:[{name:"show",rawName:"v-show",value:"purchases"===t.type,expression:"type==='purchases'"},{name:"loading",rawName:"v-loading",value:t.tableloading,expression:"tableloading"}],staticStyle:{width:"100%"},attrs:{"row-key":t.generateUUID(),data:t.tableData,height:"350"}},[e("el-table-column",{attrs:{prop:"id",label:"订单ID",width:"200"}}),e("el-table-column",{attrs:{prop:"user_id",label:"用户ID",width:"200"}}),e("el-table-column",{attrs:{prop:"user_info.name",label:"用户名",width:"200"}}),e("el-table-column",{attrs:{prop:"user_info.wechat_nickname",label:"微信名",width:"200"}}),e("el-table-column",{attrs:{prop:"eeee",label:""}}),e("el-table-column",{attrs:{prop:"totalMoney",label:"金额",width:"180",align:"center"}}),e("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.myreplace(e.row.create_time))+" ")]}}])}),e("el-table-column",{attrs:{label:"支付状态",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return["未支付"===a.row.status?e("el-tag",[t._v(t._s(a.row.status)+" ")]):e("el-tag",{attrs:{type:"success"}},[t._v(t._s(a.row.status)+" ")])]}}])})],1),e("el-table",{directives:[{name:"show",rawName:"v-show",value:"shoppings"===t.type,expression:"type==='shoppings'"},{name:"loading",rawName:"v-loading",value:t.tableloading,expression:"tableloading"}],staticStyle:{width:"100%"},attrs:{"row-key":t.generateUUID(),data:t.tableData,height:"350"}},[e("el-table-column",{attrs:{prop:"id",label:"购物ID",width:"200"}}),e("el-table-column",{attrs:{prop:"user_id",label:"用户ID",width:"200"}}),e("el-table-column",{attrs:{prop:"product_id",label:"商品ID",width:"200"}}),e("el-table-column",{attrs:{prop:"wechat_nickname",label:""}}),e("el-table-column",{attrs:{prop:"product_num",label:"数量",width:"180",align:"center"}}),e("el-table-column",{attrs:{label:"创建时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t.myreplace(e.row.create_time))+" ")]}}])})],1),e("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.currentPage,"page-size":5,background:"",layout:"prev, pager, next",total:t.TotalPage},on:{"current-change":t.handleCurrentChange}})],1)],1),e("Echart1",{staticStyle:{display:"none"},attrs:{x_data:t.Echart1.x_data,y_data:t.Echart1.y_data,color:t.Echart1.color,title:t.Echart1.title}})],1)},r=[],i=a("c7eb"),l=a("1da1"),o=(a("fb6a"),a("ace4"),a("d3b7"),a("ac1f"),a("25f0"),a("5319"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("159b"),function(){var t=this,e=t._self._c;return e("el-row",{staticClass:"panel-group",attrs:{gutter:40}},t._l(t.dashboard,(function(a,n){return e("el-col",{key:n,staticClass:"card-panel-col",attrs:{xs:12,sm:8,lg:4}},[e("div",{staticClass:"card-panel"},[e("div",{staticClass:"card-panel-description"},[e("div",{staticClass:"card-panel-text"},[t._v(" "+t._s(t.dashboard_name[n])+" "),e("div",{directives:[{name:"show",rawName:"v-show",value:"number"===typeof a&&a>t.dashboard_params_yesterday[n],expression:"typeof item === 'number' && item>dashboard_params_yesterday[key]"}],staticClass:"triangle"})]),e("div",{staticClass:"card-panel-num"},[t._v(" "+t._s(a)+" ")])])])])})),1)}),s=[],c=a("3835"),u=(a("4fad"),a("a27e")),d={components:{},data:function(){return{dashboard:{role:null,name:null,home_visit_num:null,dashboard_visit_num:null,request_num:null,product_num:null,user_num:null,comment_num:null,chat_num:null,kefu_num:null},dashboard_name:{name:"姓名",role:"角色",home_visit_num:"首页访客",dashboard_visit_num:"后台访客",request_num:"总请求数",product_num:"文章数",user_num:"用户数",comment_num:"评论数",chat_num:"聊天条数",kefu_num:"GPT对话"},dashboard_params_yesterday:{}}},methods:{handleSetLineChartData:function(t){this.$emit("handleSetLineChartData",t)},return_color:function(){var t=["shopping","money","message","people"];return t[Math.floor(Math.random()*t.length)]}},mounted:function(){var t=this;u["a"].get("/user-agent-details/init_dashboard").then((function(e){console.log(e.data);for(var a=0,n=Object.entries(e.data);a<n.length;a++){var r=Object(c["a"])(n[a],2),i=r[0],l=r[1];"dashboard_params_yesterday"!==i?t.dashboard[i]=l:t.dashboard_params_yesterday=l}})).catch((function(t){console.log(t)}))}},h=d,p=(a("571c"),a("2877")),m=Object(p["a"])(h,o,s,!1,null,"c6a42032",null),f=m.exports,b=function(){var t=this,e=t._self._c;return e("div",{ref:"chart",class:t.className,style:{height:t.height,width:t.width}})},g=[],_=(a("99af"),a("22b4")),w=a("1be7"),y=a("3620"),v=a("9394"),x=a("2da7"),D=a("4b2a"),C=a("f95e"),k=a("2ef0");_["a"]([v["a"],x["a"],D["a"],y["a"],C["a"]]),a("817d");var S={props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,required:!0}},data:function(){return{chart:null,throttledResize:null}},watch:{chartData:{deep:!0,handler:function(t){this.setOptions(t)}}},mounted:function(){var t=this;this.$nextTick((function(){t.initChart()})),this.throttledResize=Object(k["debounce"])(this.redraw,200),window.addEventListener("resize",this.throttledResize)},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null,window.removeEventListener("resize",this.throttledResize))},methods:{initChart:function(){var t=this,e=this.$refs.chart;this.chart=w["l"](e),this.setOptions(this.chartData),this.chart.on("click",(function(e){"series"===e.componentType&&(console.log("点击了图表的点:",e),t.handlePointClick(e))}))},handlePointClick:function(t){console.log("你点击了 ".concat(t.name," 的点")),this.$emit("PointClick",t.dataIndex)},setOptions:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.actualData;console.log("!!!!!!"+this.chartData.name),this.chart.setOption({xAxis:{data:this.getLast7Days(),boundaryGap:!1,axisTick:{show:!1}},grid:{left:20,right:25,bottom:20,top:30,containLabel:!0},tooltip:{trigger:"axis",axisPointer:{type:"cross"},padding:[5,10]},yAxis:{axisTick:{show:!1}},legend:{data:[this.chartData.name]},series:[{name:this.chartData.name,smooth:!0,type:"line",itemStyle:{normal:{color:this.chartData.color,lineStyle:{color:this.chartData.color,width:2},areaStyle:{color:"#f3f8ff"}}},data:e,animationDuration:2800,animationEasing:"quadraticOut"}]})},getLast7Days:function(){for(var t=[],e=6;e>=0;e--){var a=new Date;a.setDate(a.getDate()-e);var n="".concat(a.getMonth()+1,"月").concat(a.getDate(),"日");t.push(n)}return t},redraw:function(){this.chart.resize(),console.log("窗口大小改变了,防抖重绘:",window.innerWidth,window.innerHeight)}}},P=S,O=Object(p["a"])(P,b,g,!1,null,null,null),L=O.exports,j=function(){var t=this,e=t._self._c;return e("div",{ref:"chart",staticStyle:{width:"600px",height:"400px"}})},N=[];_["a"]([v["a"],x["a"],D["a"],y["a"],C["a"]]);var T={name:"LineChart",data:function(){return{chart:null}},props:{x_data:Array,y_data:Array,color:String,title:String},mounted:function(){this.initChart()},methods:{initChart:function(){var t=this.$refs.chart;this.chart=w["l"](t),this.updateChart()},updateChart:function(){var t={title:{text:this.title},xAxis:{type:"category",boundaryGap:!1,data:this.x_data},yAxis:{type:"value"},series:[{data:this.y_data,type:"line",smooth:!0,areaStyle:{color:this.color}}]};this.chart.setOption(t)}},beforeDestroy:function(){this.chart&&this.chart.dispose()},watch:{x_data:function(){this.updateChart()},y_data:function(){this.updateChart()},color:function(){this.updateChart()},title:function(){this.updateChart()}}},E=T,I=(a("e70f"),Object(p["a"])(E,j,N,!1,null,"ef1a6dc2",null)),z=I.exports,M={newVisitis:{actualData:[120,82,91,154,162,140,145],name:"访客数量",color:"#40c9c6"},messages:{name:"留言数量",actualData:[180,160,151,106,145,150,130],color:"#36a3f7"},purchases:{name:"订单数量",actualData:[120,90,100,138,142,130,130],color:"#f4516c"},shoppings:{name:"购物数量",actualData:[120,82,91,154,162,140,130],color:"#34bfa3"}},U={name:"Dashboard",components:{PanelGroup:f,Echart1:z,LineChart:L},data:function(){return{name:"unknown",Echart1:{x_data:null,y_data:null,color:null,title:null},lineChartData:M.newVisitis,response_data:null,tableData:[],val:null,currentPage:1,TotalPage:1,tableloading:!0,type:"newVisitis"}},computed:{},methods:{myreplace:function(t){return t?String(t).replace("T"," "):""},generateUUID:function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(t){return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))},handleSetLineChartData:function(t){if(this.lineChartData=M[t],console.log(t),"messages"===t)return this.$message("留言模块开发中");this.type=t,this.PointClick(6),this.getVistorsNum()},getrole:function(){var t=this;u["a"].get("/user/session").then((function(e){var a;console.log(e.data),t.name=null===(a=e.data)||void 0===a?void 0:a[0].slice(6)})).catch((function(e){t.$message.error("error"),console.log(e)})),console.log(name)},getVistorsNum:function(){var t=this;return Object(l["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["a"].get("/user-agent-details/select_dashboard_".concat(t.type)).then((function(e){console.log(e.data),t.response_data=e.data;var a=[];e.data.forEach((function(t){t.user_uuids?a.push(t.user_uuids.length):void 0!==t.count?a.push(t.count):a.push(0)})),M[t.type].actualData=a})).catch((function(t){console.log(t)}));case 2:case"end":return e.stop()}}),e)})))()},init_dashboard_echarts_data:function(){var t=this;return Object(l["a"])(Object(i["a"])().mark((function e(){return Object(i["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.getrole(),e.next=3,t.getVistorsNum();case 3:setTimeout((function(){t.PointClick(6)}),200);case 4:case"end":return e.stop()}}),e)})))()},PointClick:function(t){var e,a=this;this.tableloading=!0,this.val=t,u["a"].post("/user-agent-details/select_dashboard_".concat(this.type,"/click"),{create_time:null===this||void 0===this||null===(e=this.response_data[t])||void 0===e?void 0:e.create_time,currentPage:this.currentPage}).then((function(t){a.tableData=t.data.records,a.TotalPage=t.data.total,a.currentPage=t.data.current,console.log(t)})).catch((function(t){console.log(t)})).finally((function(){a.tableloading=!1}))},handleCurrentChange:function(t){this.currentPage=t,this.PointClick(this.val)},repla:function(t){return null==t||"undefined"===typeof t?"":t.replace(/,/g,"<br>")},isWithinOneMinute:function(t){var e=6e4,a=new Date(t),n=new Date,r=n-a;return r<=e}},mounted:function(){this.init_dashboard_echarts_data()}},V=U,A=(a("2a12"),Object(p["a"])(V,n,r,!1,null,"8b6ef118",null));e["default"]=A.exports},a1d5:function(t,e,a){},e128:function(t,e,a){},e40e:function(t,e,a){},e70f:function(t,e,a){"use strict";a("e128")}}]);