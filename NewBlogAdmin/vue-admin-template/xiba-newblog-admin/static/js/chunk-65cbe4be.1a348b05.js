(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65cbe4be"],{"3eee":function(e,t,a){"use strict";a.r(t);a("b0c0"),a("ac1f"),a("5319");var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"app-container"},[t("div",{staticStyle:{margin:"0 0 20px 0"}},[t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.OpenDialog("删除订单")}}},[e._v("删除")]),t("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){return e.OpenDialog("查询订单")}}},[e._v("查询")]),e._l(e.tags,(function(a){return t("el-tag",{key:a.name,staticStyle:{margin:"10px 10px 0 20px","padding-left":"10px"},attrs:{"disable-transitions":!0,closable:"",type:a.type},on:{close:function(t){return e.removeTag(a.key)}}},[e._v(" "+e._s(a.name)+" ")])}))],2),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.IsTableLoading,expression:"IsTableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{attrs:{type:"selection",align:"center",width:"40"}}),e._l(this.columns,(function(a,l){return t("el-table-column",{key:l,attrs:{prop:a.prop,label:a.label,width:a.width,align:a.align},scopedSlots:e._u([{key:"default",fn:function(l){return["访问时间"===a.label?t("div",[e._v(e._s(e.tableData[l.$index][a.prop]?e.tableData[l.$index][a.prop].replace(/T/g," "):null))]):"姓名"===a.label?t("div",[e._v(e._s(e.isValidUUID(e.tableData[l.$index][a.prop])?"UUID值":e.tableData[l.$index][a.prop]))]):"用户名"===a.label?t("div",[e._v(" "+e._s(e.tableData[l.$index][a.prop]?e.isValidUUID(e.tableData[l.$index][a.prop])?"UUID值":e.tableData[l.$index][a.prop]:"未登录")+" ")]):t("div",[e._v(" "+e._s(e.tableData[l.$index][a.prop])+" ")])]}}],null,!0)})}))],2),t("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15,20],"page-size":e.PageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.TotalPage},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:this.dialog_title2,visible:e.dialogVisible2,width:"60%"},on:{"update:visible":function(t){e.dialogVisible2=t}}},[t("el-form",{ref:"form",staticStyle:{margin:"0 20px 0 0"},attrs:{rules:e.rules,"label-position":"right",model:e.dialogdata2,"label-width":"80px"}},[t("el-row",{attrs:{gutter:20}},[e._l(e.columns,(function(a,l){return t("el-col",{key:l,attrs:{span:12}},["ID"===a.label||"创建时间"===a.label||"版本"===a.label||"图像"===a.label?t("span"):t("el-form-item",{attrs:{label:a.label,prop:a.prop}},[t("el-input",{model:{value:e.dialogdata2[a.prop],callback:function(t){e.$set(e.dialogdata2,a.prop,t)},expression:"dialogdata2[column.prop]"}})],1)],1)})),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"图像",prop:"photo"}},[t("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{margin:"5px 0 0 5px"},attrs:{"show-file-list":!0,"file-list":e.fileList,action:"#",limit:1,"before-upload":e.beforeUpload,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-exceed":e.handleExceed,"http-request":e.handleFileUpload,"list-type":"picture"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png一张，且不超过500kb")])],1)],1)],1)],2)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible2=!1,e.gettable()}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.confirm_change}},[e._v("确定")])],1)],1),t("El2",{ref:"address",staticStyle:{"text-align":"left","margin-left":"20px","margin-bottom":"20px"},on:{address:e.address_finish}}),t("el-dialog",{attrs:{title:this.dialog_title3,visible:e.dialogVisible3,width:"60%"},on:{"update:visible":function(t){e.dialogVisible3=t}}},[t("el-form",{ref:"form2",staticStyle:{margin:"0 20px 0 0"},attrs:{"label-position":"right",model:e.dialogdata3,"label-width":"80px"}},[t("el-row",{attrs:{gutter:20}},e._l(e.columns2,(function(a,l){return t("el-col",{key:l,attrs:{span:12}},[t("el-form-item",{attrs:{label:a.label,prop:a.prop}},["时间"===a.label?t("div",{staticStyle:{display:"flex"}},[t("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间"},model:{value:e.dialogdata3.startDate,callback:function(t){e.$set(e.dialogdata3,"startDate",t)},expression:"dialogdata3.startDate"}}),t("el-date-picker",{attrs:{type:"datetime",placeholder:"选择结束时间"},model:{value:e.dialogdata3.endDate,callback:function(t){e.$set(e.dialogdata3,"endDate",t)},expression:"dialogdata3.endDate"}})],1):t("el-input",{staticStyle:{"max-width":"250px"},model:{value:e.dialogdata3[a.prop],callback:function(t){e.$set(e.dialogdata3,a.prop,t)},expression:"dialogdata3[column.prop]"}})],1)],1)})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible3=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.gotosearch()}}},[e._v("确定")])],1)],1)],1)},i=[],o=a("3835"),s=a("5530"),n=(a("99af"),a("4de4"),a("caad"),a("d81d"),a("a434"),a("e9c4"),a("4fad"),a("b64b"),a("d3b7"),a("07ac"),a("00b4"),a("159b"),a("a27e")),r=a("092a"),d={components:{El2:r["a"]},data:function(){return{staticPath:"https://www.yjztest.top/xiba-newblog/img/",photo:null,fileList:[],tableData:[],currentPage:1,PageSize:10,TotalPage:null,IsTableLoading:!0,columns:[{prop:"create_time",label:"访问时间",width:"160"},{prop:"visitor_name",label:"用户名",width:"80"},{prop:"wechat_nickname",label:"微信名",width:"80"},{prop:"realIp",label:"访问ip",width:"120"},{prop:"city",label:"ip地点",width:"120"},{prop:"originalURI",label:"访问URL"},{prop:"method",label:"访问方法",width:"80"},{prop:"forwardedProto",label:"协议",width:"60"},{prop:"deviceClass",label:"设备",width:"80"},{prop:"deviceBrand",label:"设备品牌",width:"80"},{prop:"deviceFirmwareVersion",label:"版本",width:"80"},{prop:"operatingSystemName",label:"操作系统",width:"120"},{prop:"operatingSystemVersion",label:"版本",width:"60"},{prop:"agentName",label:"浏览器",width:"80"},{prop:"agentVersion",label:"版本",width:"80"},{prop:"user_uuid",label:"访客标识",width:"300"}],dialogVisible2:!1,dialog_title2:"",dialogdata2:{id:null,name:null,price:null,num:null,photo:null,info:null,type:null,create_time:null,version:null},radio:null,addresses:[],rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"},{validator:function(e,t,a){t?/^\d+$/.test(t)?t<=0||t>=1e6?a(new Error("数字必须大于0且小于7位数")):a():a(new Error("只能输入数字")):a(new Error("请输入数字值"))},trigger:"blur"}],num:[{required:!0,message:"请输入数量",trigger:"blur"},{validator:function(e,t,a){t?/^\d+$/.test(t)?t<=0||t>=1e6?a(new Error("数字必须大于0且小于7位数")):a():a(new Error("只能输入数字")):a(new Error("请输入数字值"))},trigger:"blur"}]},rows_selection:[],dialogVisible3:!1,dialog_title3:"查询筛选添加",dialogdata3:{ip:null,ip_location:null,url:null,method:null,device:null,brand:null,brand_version:null,os:null,os_version:null,browser:null,uuid:null,startDate:null,endDate:null},columns2:[{prop:"ip",label:"Ip",width:"180"},{prop:"ip_location",label:"Ip地点",width:"80"},{prop:"url",label:"访问地址",width:"80"},{prop:"method",label:"访问方法",width:"80"},{prop:"device",label:"设备",width:"80"},{prop:"brand",label:"品牌",width:"80"},{prop:"brand_version",label:"品牌版本",width:"80"},{prop:"os",label:"操作系统",width:"80"},{prop:"os_version",label:"系统版本",width:"180"},{prop:"browser",label:"浏览器",width:"80"},{prop:"uuid",label:"访客标识",width:"80"},{prop:"create_time",label:"时间",width:"80"},{prop:"visitor_name",label:"用户名",width:"80"},{prop:"wechat_nickname",label:"微信名",width:"80"}],tags:[]}},methods:{exist:function(e){return null!==e?","+e:""},handleImageError:function(e){console.log("handleImageError"),console.log(this.staticPath+"deletedproduct.webp"),e.target.src=this.staticPath+"deletedproduct.webp"},init_dialogdata2_photo:function(){var e,t;console.log("this.$refs.upload.uploadFiles?.[0]?.raw"),console.log(null===(e=this.$refs.upload)||void 0===e||null===(e=e.uploadFiles)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.raw),console.log(this.dialogdata2),"noproduct"!==this.dialogdata2.photo&&(this.fileList=[{name:"".concat(null===(t=this.dialogdata2)||void 0===t?void 0:t.photo,".webp"),url:"".concat(this.staticPath).concat(this.dialogdata2.photo,".webp")}])},handleFileUpload:function(e){var t;console.log("submit"),this.photo=e,console.log(null===(t=this.$refs.upload.uploadFiles)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.raw)},beforeUpload:function(e){console.log("beforeUpload!");var t=["image/jpeg","image/png"],a=t.includes(e.type),l=e.size/1024<500;return a?!!l||(this.$message.error("上传文件大小不能超过 500KB!"),!1):(this.$message.error("只能上传jpg/png文件!"),!1)},handleRemove:function(e,t){var a;console.log("remove"),console.log(e,t),console.log(null===(a=this.$refs.upload)||void 0===a||null===(a=a.uploadFiles)||void 0===a||null===(a=a[0])||void 0===a?void 0:a.raw),this.dialogdata2.photo="noproduct"},handlePreview:function(e){console.log("preview"),console.log(e)},handleExceed:function(){this.$message.error("只能上传一张图片")},address_finish:function(e,t){if(console.log("父组件"),console.log(e),console.log(t),"新增地址"===this.$refs.address.dialog_title){var a=JSON.parse(JSON.stringify(t));null!==a&&void 0!==a&&a.is_default&&this.addresses.forEach((function(e){e.is_default=!1})),this.addresses.push(a)}else if("更改地址"===this.$refs.address.dialog_title){var l=JSON.parse(JSON.stringify(t));console.log(l),null!==l&&void 0!==l&&l.is_default&&this.addresses.forEach((function(e){e.is_default=!1})),this.$set(this.addresses,e,l)}else this.$message.error("走到这一步，说明你写错了");console.log(this.addresses)},delete_address:function(e){console.log(e),this.addresses.splice(e,1)},new_address:function(){this.$refs.address.dialogdata={info:[],info_code:[],name:"",phone:"",detail:"",is_default:!1},this.$refs.address.dialog_title="新增地址",this.$refs.address.dialogVisible=!0},change_address:function(e,t){this.$refs.address.dialogdata=JSON.parse(JSON.stringify(t)),this.$refs.address.dialog_title="更改地址",this.$refs.address.dialogindex=e,this.$refs.address.dialogVisible=!0},gettable:function(){var e=this;this.IsTableLoading=!0,n["a"].get("/user-agent-details/selectbyadmin",{params:{currentPage:this.currentPage,PageSize:this.PageSize}}).then((function(t){0===t.data.code?e.$message.error(t.data.msg):(e.tableData=t.data.data.records,e.TotalPage=t.data.data.total,e.IsTableLoading=!1)})).catch((function(t){e.$message.error(t.data.msg),console.log(t)}))},handleSizeChange:function(e){this.PageSize=e,this.gettablebycondition()},handleCurrentChange:function(e){this.currentPage=e,this.gettablebycondition()},handleSelectionChange:function(e){console.log(e),this.rows_selection=e},OpenDialog:function(e){var t,a=this;if("新增访客记录"===e)this.dialogdata2={id:null,name:null,price:null,num:null,photo:null,info:null,type:null,create_time:null,version:null},null===(t=this.$refs.form)||void 0===t||t.resetFields(),this.dialog_title2=e,this.dialogVisible2=!0;else if("删除订单"===e){if(0===this.rows_selection.length)return void this.$message.error("请选择要删除的历史记录");this.$confirm("确定删除这"+this.rows_selection.length+"个访客记录吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.delete_byadmin()})).catch((function(){a.$message({type:"info",message:"已取消删除"})}))}else if("修改访客记录"===e){var l,i;if(0===this.rows_selection.length)return void this.$message.error("请选择要修改的访客记录");if(1!==this.rows_selection.length)return void this.$message.error("一次只能修改一个访客记录");this.dialogdata2=null===(l=this.rows_selection)||void 0===l?void 0:l[0],null===(i=this.$refs.form)||void 0===i||i.resetFields(),this.dialog_title2=e,this.init_dialogdata2_photo(),this.dialogVisible2=!0}else"查询订单"===e&&(this.dialogVisible3=!0)},confirm_change:function(){var e=this;this.$refs.form.validate((function(t){t?(console.log("验证通过"),"新增访客记录"===e.dialog_title2?e.axios_add():"修改访客记录"===e.dialog_title2?e.axios_update():e.$message.error("err")):console.log("验证失败")}))},axios_add:function(){var e,t,a=this;console.log(this.$refs.upload),console.log(this.dialogdata2),console.log(null===(e=this.$refs.upload.uploadFiles)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.raw);var l=new FormData;l.append("photo",null===(t=this.$refs.upload.uploadFiles)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.raw),l.append("product_json",JSON.stringify(this.dialogdata2)),n["a"].post("/product/addonebyadmin",l,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){0===e.data.code?a.$message.error(e.data.msg):(a.dialogVisible2=!1,a.$message.success("添加成功"),a.gettablebycondition())})).catch((function(e){a.$message.error(e.data.msg),console.log(e)}))},axios_update:function(){var e,t=this;console.log(this.dialogdata2),console.log(this.$refs.upload);var a=new FormData;a.append("photo",null===(e=this.$refs.upload.uploadFiles)||void 0===e||null===(e=e[0])||void 0===e?void 0:e.raw),a.append("product_json",JSON.stringify(this.dialogdata2)),n["a"].put("/product/updateonebyadmin",a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){0===e.data.code?t.$message.error(e.data.msg):(t.dialogVisible2=!1,t.$message.success("更新成功"),t.gettablebycondition())})).catch((function(e){var a;null!==(a=e.data)&&void 0!==a&&a.msg?t.$message.error(e.data.msg):t.$message.error(e),console.log(e)}))},delete_byadmin:function(){var e=this;n["a"].post("/user-agent-details/deletelistbyadmin",this.rows_selection).then((function(t){0===t.data.code?e.$message.error(t.data.msg):(e.dialogVisible2=!1,e.$message.success("删除成功"),e.gettablebycondition())})).catch((function(t){var a;null!==(a=t.data)&&void 0!==a&&a.msg?e.$message.error(t.data.msg):e.$message.error(t),console.log(t)}))},gettablebycondition:function(){var e=this;this.IsTableLoading=!0;var t={currentPage:this.currentPage,PageSize:this.PageSize},a=Object(s["a"])(Object(s["a"])({},t),this.dialogdata3);n["a"].get("/user-agent-details/selectbyadmin",{params:a}).then((function(t){if(0===t.data.code)e.$message.error(t.data.msg);else{e.tableData=t.data.data.records,e.TotalPage=t.data.data.total,e.IsTableLoading=!1;for(var a={},l=0,i=Object.entries(t.data.map);l<i.length;l++){var s=Object(o["a"])(i[l],2),n=s[0],r=s[1];"currentPage"!==n&&"PageSize"!==n&&(a[n]=r)}e.dialogdata3=a,e.init_Tags()}})).catch((function(t){e.$message.error(t.data.msg),console.log(t)}))},init_Tags:function(){var e=[];console.log(this.dialogdata3);for(var t=0,a=Object.entries(this.dialogdata3);t<a.length;t++){var l=Object(o["a"])(a[t],2),i=l[0],s=l[1];if(console.log(i+": "+s),null!==s){var n=i;"name"===i&&(n="姓名"),"startDate"===i&&(n="开始日期"),"endDate"===i&&(n="结束日期"),e.push({name:"".concat(n," : ").concat(s),type:"success",key:i})}}this.tags=e},gotosearch:function(){for(var e=!0,t=0,a=Object.values(this.dialogdata3);t<a.length;t++){var l=a[t];if(null!==l){e=!1;break}}e?this.$message.error("无筛选参数"):(this.init_Tags(),this.dialogVisible3=!1,this.gettablebycondition())},removeTag:function(e){console.log(e),this.tags=this.tags.filter((function(t){return t.key!==e}));for(var t={id:null,name:null,startDate:null,endDate:null},a=0,l=Object.entries(this.dialogdata3);a<l.length;a++){var i=Object(o["a"])(l[a],2),s=i[0],n=i[1];e!==s&&(t[s]=n)}this.dialogdata3=t,console.log(this.dialogdata3),this.gettablebycondition()},isValidUUID:function(e){var t=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;return t.test(e)}},mounted:function(){this.gettablebycondition()},watch:{dialogVisible2:function(){this.dialogVisible2||this.$refs.upload&&this.$refs.upload.uploadFiles.splice(0)}}},c=d,p=(a("4dcb"),a("2877")),u=Object(p["a"])(c,l,i,!1,null,"3c3e454c",null);t["default"]=u.exports},"4dcb":function(e,t,a){"use strict";a("8de6")},"4fad":function(e,t,a){var l=a("23e7"),i=a("6f53").entries;l({target:"Object",stat:!0},{entries:function(e){return i(e)}})},"6f53":function(e,t,a){var l=a("83ab"),i=a("df75"),o=a("fc6a"),s=a("d1e7").f,n=function(e){return function(t){var a,n=o(t),r=i(n),d=r.length,c=0,p=[];while(d>c)a=r[c++],l&&!s.call(n,a)||p.push(e?[a,n[a]]:n[a]);return p}};e.exports={entries:n(!0),values:n(!1)}},"8de6":function(e,t,a){}}]);