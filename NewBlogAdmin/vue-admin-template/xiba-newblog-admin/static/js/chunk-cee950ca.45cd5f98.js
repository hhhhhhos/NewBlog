(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cee950ca"],{6460:function(t,e,a){"use strict";a("8263")},8263:function(t,e,a){},"8f03":function(t,e,a){"use strict";a.r(e);a("99af"),a("caad"),a("fb6a"),a("b0c0"),a("8a79"),a("2532");var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"show"},[t._e(),e("div",{staticStyle:{display:"flex"}},[e("p",[t._v("当前路径")]),e("i",{staticClass:"el-icon-arrow-left myback",on:{click:t.removeLastPartAndGet}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.path,expression:"path"}],staticStyle:{margin:"10px 0 0 10px",width:"300px",height:"2rem"},domProps:{value:t.path},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getphotoall.apply(null,arguments)},input:function(e){e.target.composing||(t.path=e.target.value)}}}),e("el-button",{staticStyle:{height:"32px",margin:"10px 10px 0 10px",display:"flex","justify-content":"center","align-items":"center"},on:{click:t.deletelistphoto}},[t._v(" 删除 ")]),e("el-button",{staticStyle:{height:"32px",margin:"10px 10px 0 10px",display:"flex","justify-content":"center","align-items":"center"},on:{click:t.postnewfolder}},[t._v(" 新建文件夹 ")]),e("el-button",{staticStyle:{height:"32px",margin:"10px 10px 0 10px",display:"flex","justify-content":"center","align-items":"center"},on:{click:t.addnewphotointhisurl}},[t._v(" 上传 ")]),e("input",{staticStyle:{margin:"15px 10px 0 10px"},attrs:{type:"file",id:"imageInput",accept:"image/*"}})],1),e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.ploading,expression:"ploading"}],staticStyle:{display:"flex","flex-wrap":"wrap",height:"70vh",overflow:"scroll","background-color":"white"}},t._l(this.photo_list,(function(a,n){return e("div",{key:n,staticClass:"photo"},[a.name.endsWith(".webp")||a.name.endsWith(".jpg")||a.name.endsWith(".png")?e("div",[e("el-image",{staticClass:"img",staticStyle:{cursor:"pointer"},attrs:{lazy:"","preview-src-list":[t.photo_forward_url+a.name],title:a.name,src:t.photo_forward_url+a.name}}),e("p",{attrs:{title:a.name}},[t._v(t._s(a.name))]),e("p",[t._v(t._s(a.size))])],1):a.name.includes(".")?e("div",[e("el-image",{staticClass:"img",staticStyle:{cursor:"pointer"},attrs:{"preview-src-list":[t.photo_forward_url+a.name],title:a.name,src:t.photo_forward_url+"unknown_icon.png"},nativeOn:{click:function(e){return t.getfile(t.path+a.name)}}}),e("p",{attrs:{title:a.name}},[t._v(t._s(a.name))]),e("p",[t._v(t._s(a.size))])],1):e("div",[e("i",{staticClass:"el-icon-folder-opened img folder",staticStyle:{cursor:"pointer","font-size":"150px",color:"bisque"},attrs:{title:a.name},on:{click:function(e){t.path.endsWith("/")?(t.path=t.path+a.name,t.getphotoall()):(t.path=t.path+"/"+a.name,t.getphotoall())}}}),e("p",{attrs:{title:a.name}},[t._v(t._s(a.name))]),e("p",[t._v("  ")])]),e("input",{directives:[{name:"model",rawName:"v-model",value:a.is_selected,expression:"column.is_selected"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(a.is_selected)?t._i(a.is_selected,null)>-1:a.is_selected},on:{change:function(e){var n=a.is_selected,i=e.target,o=!!i.checked;if(Array.isArray(n)){var s=null,r=t._i(n,s);i.checked?r<0&&t.$set(a,"is_selected",n.concat([s])):r>-1&&t.$set(a,"is_selected",n.slice(0,r).concat(n.slice(r+1)))}else t.$set(a,"is_selected",o)}}})])})),0)],1)},i=[],o=a("c7eb"),s=a("1da1"),r=(a("d3b7"),a("ac1f"),a("3ca3"),a("466d"),a("159b"),a("ddb0"),a("2b3d"),a("9861"),a("8f80")),l=a("a27e"),c={components:{"van-uploader":r["a"]},data:function(){return{fileList:[{url:"https://img01.yzcdn.cn/vant/leaf.jpg"},{url:"https://cloud-image",isImage:!0}],photo_list:[],photo_forward_url:"https://www.yjztest.top/xiba-newblog/img/",path:"/",ploading:!0}},methods:{getfile:function(t){var e=this;return Object(s["a"])(Object(o["a"])().mark((function a(){var n;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:n=new FormData,n.append("url",t),l["a"].post("/photo/getfile",n,{headers:{"Content-Type":"multipart/form-data"},responseType:"blob"}).then((function(a){if(a.data){var n=a.headers["content-disposition"],i=n&&n.match(/filename="(.+)"/),o=i?i[1]:t,s=window.URL.createObjectURL(new Blob([a.data])),r=document.createElement("a");r.href=s,r.setAttribute("download",o),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}else e.$message.error("获取失败")}));case 3:case"end":return a.stop()}}),a)})))()},addnewphotointhisurl:function(){this.uploadImage()},uploadImage:function(){var t=this,e=document.getElementById("imageInput");if(e.files&&e.files[0]){var a=e.files[0];if(!a||!this.path)return this.$message.error("不能为空");var n=new FormData;n.append("photo",a),n.append("url",this.path),l["a"].post("/photo/addonebyadmin",n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(e){e.data?(t.$message.success("图片上传成功:",e),t.getphotoall()):t.$message.error("上传失败")})).catch((function(e){t.$message.error("error:",e)}))}else this.$message.error("不能为空")},postnewfolder:function(){var t=this;this.$prompt("请输入文件夹名（或文件夹路径）","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(e){var a=e.value;l["a"].post("/photo/folderbyadmin?path=".concat(t.path,"/").concat(a)).then((function(e){e.data?(t.$message.success("成功创建"),t.getphotoall()):t.$message.error("创建失败")})).catch((function(e){t.$message.error(e)}))})).catch((function(){}))},deletelistphoto:function(){var t=this,e=[];if(this.photo_list.forEach((function(a){a.is_selected&&e.push(t.path.endsWith("/")?t.path+a.name:t.path+"/"+a.name)})),!e.length)return this.$message.error("未选择图片");this.$confirm("确定删除这"+e.length+"个图吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l["a"].delete("/photo/listbyadmin",{data:e}).then((function(e){t.$message(e.data),t.getphotoall()})).catch((function(e){t.$message.error(e)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},removeLastPartAndGet:function(){if("/"===this.path)return this.$message.error("已是顶格");var t=this.path.lastIndexOf("/");this.path=-1!==t&&0!==t?this.path.substring(0,t):"/",this.getphotoall()},getphotoall:function(){var t=this;this.ploading=!0,l["a"].get("/photo/all?path="+this.path).then((function(e){e.data.code?(t.photo_list=e.data.data,t.photo_list.forEach((function(t){t.is_selected=!1})),t.ploading=!1):(t.$message.error(e.data.msg),t.photo_list=[])}))}},mounted:function(){this.getphotoall()}},p=c,h=(a("6460"),a("2877")),d=Object(h["a"])(p,n,i,!1,null,"51fe324e",null);e["default"]=d.exports}}]);